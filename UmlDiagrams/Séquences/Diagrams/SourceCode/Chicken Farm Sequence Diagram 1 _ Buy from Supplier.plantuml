@startuml BuyFromSupplier
actor Administration
actor Cashier
actor Supplier
participant OrderUI
participant Database

Note over Administration: One-time: Register suppliers<br/>(ICE, RC, products, payment terms)

Administration->>OrderUI: Register supplier
OrderUI->>Database: Save supplier

Note over Administration,Supplier: Send initial order to multiple suppliers

Administration->>OrderUI: Create "Bon de Commande Initial"<br/>(product specs, quantity)
loop 3 food suppliers, 2 meds, 5 chicks, etc.
    Administration->>Supplier: Send initial order
end
OrderUI->>Database: Save orders (INITIAL_SENT)

Supplier-->>Administration: Send "Devis" (quotations)

Administration->>OrderUI: Enter all quotations
OrderUI->>OrderUI: Calculate weighted scores<br/>(cost, quality, delivery time)
OrderUI-->>Administration: Show ranked suppliers

Administration->>OrderUI: Select best supplier
OrderUI->>Database: Update (FINAL_READY)

Administration->>Supplier: Send "Bon de Commande Final"

Supplier->>Administration: Deliver + "Bon de Livraison"

alt Products OK
    Administration->>OrderUI: Approve delivery
    OrderUI->>Database: Update (DELIVERED) + inventory
    Administration->>Supplier: Send approved copy
else Damaged/wrong quantity
    Supplier->>Administration: Send "Avoir" (credit note)
    Administration->>OrderUI: Record credit
    OrderUI->>Database: Adjust amount
end

Supplier->>Administration: Send "Facture"
Cashier->>OrderUI: Record payment (method, amount, date)
OrderUI->>Database: Save payment + expense record
@enduml