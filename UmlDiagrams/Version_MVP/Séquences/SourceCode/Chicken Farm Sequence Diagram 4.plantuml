@startuml MVP_Sequence_Diagram_4_Eggs_Bay

title Sequence Diagram 4: View Eggs Bay

actor "Admin User" as Admin
participant "EggsBayView" as UI
participant "EggsBayController" as Controller
participant "EggProductionDAO" as EggDAO
participant "HouseDAO" as HouseDAO
participant "MortalityDAO" as MortalityDAO
participant "DatabaseConnection" as DB

== Initialize Eggs Bay View ==

Admin -> UI: Navigate to Eggs Bay

UI -> Controller: initialize()
activate Controller

note right of Controller
    <b>Displays production for:</b>
    • House 2 (Egg Layers)
    • House 3 (Meat Females)
    • Total eggs in storage
end note

== Load House 2 Production ==

Controller -> HouseDAO: getHouseByNumber(2)
activate HouseDAO
HouseDAO -> DB: SELECT * FROM houses\nWHERE house_number = 2
activate DB
DB --> HouseDAO: House 2 record
deactivate DB
HouseDAO --> Controller: House object
deactivate HouseDAO

Controller -> EggDAO: getProductionByHouse(house2ID)
activate EggDAO
EggDAO -> DB: SELECT SUM(eggs_collected)\nFROM egg_production\nWHERE house_id = ?\nAND collection_date = TODAY()
activate DB
DB --> EggDAO: 2,400 eggs
deactivate DB
EggDAO --> Controller: 2,400 eggs today
deactivate EggDAO

Controller -> MortalityDAO: getMortalityByHouse(house2ID)
activate MortalityDAO
MortalityDAO -> DB: SELECT SUM(count)\nFROM mortality\nWHERE house_id = ?\nAND death_date = TODAY()
activate DB
DB --> MortalityDAO: 1 death
deactivate DB
MortalityDAO --> Controller: 1 dead chicken
deactivate MortalityDAO

Controller -> UI: Create H2 production card:\n• Eggs today: 2,400\n• Dead chickens: 1

== Load House 3 Production ==

Controller -> HouseDAO: getHouseByNumber(3)
activate HouseDAO
HouseDAO -> DB: SELECT * FROM houses\nWHERE house_number = 3
activate DB
DB --> HouseDAO: House 3 record
deactivate DB
HouseDAO --> Controller: House object
deactivate HouseDAO

Controller -> EggDAO: getProductionByHouse(house3ID)
activate EggDAO
EggDAO -> DB: SELECT SUM(eggs_collected)\nFROM egg_production\nWHERE house_id = ?\nAND collection_date = TODAY()
activate DB
DB --> EggDAO: 1,800 eggs
deactivate DB
EggDAO --> Controller: 1,800 eggs today
deactivate EggDAO

Controller -> MortalityDAO: getMortalityByHouse(house3ID)
activate MortalityDAO
MortalityDAO -> DB: SELECT SUM(count)\nFROM mortality\nWHERE house_id = ?\nAND death_date = TODAY()
activate DB
DB --> MortalityDAO: 2 deaths
deactivate DB
MortalityDAO --> Controller: 2 dead chickens
deactivate MortalityDAO

Controller -> UI: Create H3 production card:\n• Eggs today: 1,800\n• Dead chickens: 2

== Load Total Storage ==

Controller -> EggDAO: getTotalEggsInStorage()
activate EggDAO
EggDAO -> DB: SELECT SUM(clean_eggs)\nFROM egg_production\nWHERE eggs_removed IS NULL
activate DB
DB --> EggDAO: 12,050 eggs
deactivate DB
EggDAO --> Controller: 12,050 eggs
deactivate EggDAO

Controller -> UI: Create total storage card:\n• Total eggs: 12,050

deactivate Controller

UI -> Admin: Display 2 production cards + storage card



@enduml