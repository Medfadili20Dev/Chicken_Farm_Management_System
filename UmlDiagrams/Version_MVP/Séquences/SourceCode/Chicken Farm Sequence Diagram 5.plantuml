@startuml MVP_Sequence_Diagram_5_Storage

title Sequence Diagram 5: View Storage

actor "Admin User" as Admin
participant "StorageView" as UI
participant "StorageController" as Controller
participant "FeedDAO" as FeedDAO
participant "MedicationDAO" as MedicationDAO
participant "EquipmentDAO" as EquipmentDAO
participant "DatabaseConnection" as DB

== Initialize Storage View ==

Admin -> UI: Navigate to Storage

UI -> Controller: initialize()
activate Controller

note right of Controller
    <b>Storage displays:</b>
    • Feed inventory (different types)
    • Medication inventory
    • Equipment list with status
end note

== Load Feed Inventory ==

Controller -> FeedDAO: getAllFeed()
activate FeedDAO
FeedDAO -> DB: SELECT * FROM feed
activate DB
DB --> FeedDAO: List of feed records
deactivate DB
FeedDAO --> Controller: Feed list
deactivate FeedDAO

loop For each feed type
    Controller -> Controller: checkLowStock()
    note right
        Check if quantity < minThreshold
        to show warning indicator
    end note
end

Controller -> UI: Display feed card:\n• Chick Starter: 150 kg\n• Egg Layer: 200 kg\n• Meat Grower: 100 kg

== Load Medication Inventory ==

Controller -> MedicationDAO: getAllMedications()
activate MedicationDAO
MedicationDAO -> DB: SELECT * FROM medications
activate DB
DB --> MedicationDAO: List of medications
deactivate DB
MedicationDAO --> Controller: Medication list
deactivate MedicationDAO

Controller -> MedicationDAO: getLowStockCount()
activate MedicationDAO
MedicationDAO -> DB: SELECT COUNT(*)\nFROM medications\nWHERE quantity < min_threshold
activate DB
DB --> MedicationDAO: 2 medications
deactivate DB
MedicationDAO --> Controller: 2 low stock items
deactivate MedicationDAO

Controller -> UI: Display medication card:\n• Total types: 8\n• Low stock: 2

== Load Equipment List ==

Controller -> EquipmentDAO: getAllEquipment()
activate EquipmentDAO
EquipmentDAO -> DB: SELECT * FROM equipment
activate DB
DB --> EquipmentDAO: List of equipment
deactivate DB
EquipmentDAO --> Controller: Equipment list
deactivate EquipmentDAO

Controller -> UI: Populate equipment table:\n[Name | Count | Status]

loop For each equipment
    Controller -> UI: Add table row:\n• Feeder | 20 | OPERATIONAL\n• Waterer | 15 | OPERATIONAL\n• Nest Box | 50 | NEEDS_REPAIR
end

deactivate Controller

UI -> Admin: Display feed card, medication card,\nand equipment table


@enduml