@startuml MVP_Sequence_Diagram_6_Tasks

title Sequence Diagram 6: View Tasks

actor "Admin User" as Admin
participant "TasksView" as UI
participant "TasksController" as Controller
participant "TaskDAO" as TaskDAO
participant "PersonnelDAO" as PersonnelDAO
participant "DatabaseConnection" as DB

== Initialize Tasks View ==

Admin -> UI: Navigate to Tasks

UI -> Controller: initialize()
activate Controller

note right of Controller
    <b>Tasks display:</b>
    • List of all tasks
    • Status badges (Done/Pending/Missed)
    • Task description
    • Cracked eggs count
    • Assigned worker name
end note

== Load Tasks ==

Controller -> TaskDAO: getAllTasks()
activate TaskDAO
TaskDAO -> DB: SELECT * FROM tasks\nORDER BY due_date DESC
activate DB
DB --> TaskDAO: List of tasks
deactivate DB
TaskDAO --> Controller: Task list
deactivate TaskDAO

loop For each task
    Controller -> PersonnelDAO: getPersonnelById(assignedPersonnelID)
    activate PersonnelDAO
    PersonnelDAO -> DB: SELECT * FROM personnel\nWHERE personnel_id = ?
    activate DB
    DB --> PersonnelDAO: Personnel record
    deactivate DB
    PersonnelDAO --> Controller: Personnel object
    deactivate PersonnelDAO
    
    Controller -> Controller: determineTaskStatus()
    note right
        Status Logic:
        • DONE: Task completed
        • PENDING: Due date not passed
        • MISSED: Due date passed, not done
    end note
    
    Controller -> UI: Create task item:\n[Status Badge] Task description\nCracked: X eggs\nAssigned to: Worker Name
end

deactivate Controller

UI -> Admin: Display task list with status indicators

note left of Admin
    <b>Example task items:</b>
    
    ✅ [DONE]
    "Collect eggs from H2"
    Cracked: 15 eggs
    Assigned to: Ahmed Elbagi
    
    ⏳ [PENDING]
    "Clean House 1"
    Cracked: 0
    Assigned to: Fatima Zahra
    
    ❌ [MISSED]
    "Record mortality in H4"
    Cracked: 0
    Assigned to: Mohamed Hassan
end note

@enduml